#.travis.yml

language: node_js
node_js:
  - "node"
cache:
  - npm

addons:
  apt:
    sources:
      - google-chrome
    packages:
      - google-chrome-stable

branches:
  only:
    - master

before_script:
  - npm install -g @angular/cli
  - npm install -g wait-on
  - cd functions && npm install

script:
  - npm run lint
  - npm run build
  - cd ..
  - ng lint
  - ng build pp-pigpen --configuration=production --aot
  - npm start & wait-on http-get://localhost:4200
  - cypress run --browser chromium

notifications:
  email:
    on_failure: change
    on_success: change

deploy:
  provider: firebase
  skip_cleanup: true
  token:
    secure: "Rohr2MQOt5MogGtC+Eo5Q6nLd4AZXuyEcJobp7E4eoHI9KOwtHu9Pb8dZfnTEwdXxMjltNcLKe36TFhkzV7CJf1EHcXy6FDAc/OkRTdjeClmYeFrEW1tr7vCeVkbSzYpkREjL96ol51MZBvNhFCZ2XYFwIGjA0SkBZl+92cp761DMOI4C5cTT/bwZxGsL8T5qZoCdqbC0uz3sbQrykwrrfsFNMcY/ytnInSjUjRbah7qjkjB4xNZA8UKAzmqkOhiX7RaP9/xFKErNAidJvD2AkVXYqitMbPZ68sWW4+W/qeVT8cW+FYLUQXEmnfbQCTW72NiqdlJCf4xvmVZrCsW2kwJlLt8aQfHR9daBUkOu7PXo6E4l5u8YjLcAgf0cMlleNhq30xkd1wsJi5Vt89j7NbET4B2NsvE4OJsEH0YTwRnzLUqP3FL6ma8QPNbHcyP8RFB5qvc193W4tyVWd05D2PQSSw1c0SN3vcY2GpEiwrXtFwhhS+4Gegv/vr6bZYIQVQbkrSbZwBtAk5SqBxMr4vgxQT1y4iQ5T/EUVRnfQg3R5/4/aZvxKjzW1l+YAUYqUxYITkBBODkekNtCMzj8Qz9hv0nHkPo1noZuxDtCZLbAgQB7ldPY4t91+cDs5sy9UyUwGCvqIQVmIJKHjCkpqbsEcfGEDatzjDE3R5Zsn0="

notifications:
  webhooks: https://us-central1-pp-pigpen.cloudfunctions.net/apiTravisDeploy

